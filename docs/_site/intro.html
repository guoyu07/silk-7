<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="author" content="Jan Bernitt" />
    <meta name="description" content="Silk DI - Java dependency injection through code.">    
    <meta name="google-site-verification" content="RUSGBDySczIqgJhW3IYYfECMvXskBRw8R3g-C6N_f1I" />    
    <title> Silk DI</title>
	<style>
@import url('https://fonts.googleapis.com/css?family=Oxygen+Mono');

body, pre, code {
	font-family: 'Oxygen Mono', monospace;
}

body {
	max-width: 40em;
	padding: 1% 5%;
	font-size: 12px;
}
b, strong { color: #0088FF; font-weight: normal; }
h1 { font-size: 20px; }
h2 {
	font-weight: normal;
	padding-top: 2em;
	display: block;
	color: #DD8855;
}
pre {
	background-color: #eee;
	padding: 2px;
	tab-size: 4;
}
p code {
	color: #880000;
}
p + p {
	text-indent: 1em;
}
/* tags */
h1 + ul { padding: 0; margin: 2px; }
h1 + ul li {
	background-color: #EEEE77; color: #664400; padding: 2px; display: inline-block;
}
/* code blocks */
.kd, .kt { color: #CC44CC;}
.nf { color: #0000AA; }
.c1 { color: #00CC55; }

	</style>	
  </head>
  <body>
	<h1 id="a-different-container">A Different Container</h1>

<p>Let me try to explain why silk DI is not similar to (most) other containers like google guice, dagger or spring DI and why it matters.</p>

<h2 id="the-fancy-map-model">The Fancy Map Model</h2>

<p>Lets imagine a very simple container as a map. 
We “declare” an instance entry in that map by “attaching” a name to a class.
We “resolve” that instance by attaching the same name to a field or parameter to “tell” which instance we want.<br />
This could be called “resolution by name”. Quit simple.
This is more or less how spring started.</p>

<p>Lets add a little convenience feature: Classes with a certain feature are “added” to the container without stating it explicitly.
We would add multiple entries to the map. One for the exact canonical name of the class and one for the names of each superclass or interface (except unreasonable ones like <code>Object</code>). 
Also when “resolving” an instance without stating a name we automatically look for the instance with the target type name.
This could be called “resolution by type”. 
Spring later added it. In guice this is the “usual” way to resolve dependencies.
This, however, does constraint us to one instance per type. Too simplistic.</p>

<p>So, lets tweak our feature a little bit. When a name is used in connection with a type this is meant as a type “local” name instead of a map “global” name. In practice we can imagine this to work like before; except that we add even more entries to the map where we combine the “local” name with the class name(s) to compute further names for our map
that all lead to the very same instance. 
We can imagine that guice’s <code>@Named</code> works like that.</p>

<p>One thing got overlooked when we added “types” to the names. 
Multiple types can have the same supertype. This should not cause trouble. 
E.g. different “services” might inherit from an “abstract” service.
Still, we would never try to resolve the abstract service.
So our map’s values really should be lists of classes.
But if we actually try to resolve a name that is associated with multiple classes/instances we don’t know which one we should use and have to throw an error.
These errors should be familiar from guice and spring.
They are necessary because of the map-model.</p>

<p>While we can understand how we got to what I call “fancy map model” it requires some thought to understand why it is a poor solution.</p>

<h2 id="abstraction-and-composition">Abstraction and Composition</h2>

<p>TODO</p>

<ul>
  <li>DI =&gt; more general app wiring</li>
  <li>Ask wrong question: Ask the receiver: What instance do you want to receive?</li>
  <li>Breaks abstraction and composition: the two things the framework should have helped with</li>
</ul>

<p>Receiver should not need to know (abstraction) and must be able to receive different (composition)</p>


<footer>
&copy; 2017 <a href="http://jbee.github.io/">Jan Bernitt</a>
</footer>
  </body>
</html>
